--liquibase formatted sql

--This is for the sedmap schema
 
--changeset ajmccart:CreatePopulateSiteBasins
CREATE TABLE SEDMAP.SITE_BASINS_REF
(
  SITE_NO  VARCHAR2(255 BYTE),
  V2       VARCHAR2(255 BYTE),
  V3       VARCHAR2(255 BYTE),
  V4       VARCHAR2(255 BYTE),
  V5       VARCHAR2(255 BYTE),
  V6       VARCHAR2(255 BYTE),
  V7       VARCHAR2(255 BYTE),
  V8       VARCHAR2(255 BYTE),
  V9       VARCHAR2(255 BYTE),
  V10      VARCHAR2(255 BYTE),
  V11      VARCHAR2(255 BYTE),
  V12      VARCHAR2(255 BYTE),
  V13      VARCHAR2(255 BYTE),
  V14      VARCHAR2(255 BYTE),
  V15      VARCHAR2(255 BYTE),
  V16      VARCHAR2(255 BYTE),
  V17      VARCHAR2(255 BYTE),
  V18      VARCHAR2(255 BYTE),
  V19      VARCHAR2(255 BYTE),
  V20      VARCHAR2(255 BYTE),
  V21      VARCHAR2(255 BYTE),
  V22      VARCHAR2(255 BYTE),
  V23      VARCHAR2(255 BYTE),
  V24      VARCHAR2(255 BYTE),
  V25      VARCHAR2(255 BYTE),
  V26      VARCHAR2(255 BYTE),
  V27      VARCHAR2(255 BYTE)
);

ALTER TABLE SEDMAP.SITE_BASINS_REF ADD (
  CONSTRAINT SITE_BASINS_REF_U01
  UNIQUE (SITE_NO));
  
ALTER TABLE SEDMAP.SITE_BASINS_REF ADD (
  CONSTRAINT SITE_BASINS_REF_R01 
  FOREIGN KEY (SITE_NO) 
  REFERENCES SEDMAP.SITE_REF (SITE_NO));


insert into site_basins_ref
select 
"site_no",
  CASE WHEN V2 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V2
  END AS V2 ,
  CASE WHEN V3 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V3
  END AS V3  ,
    CASE WHEN V4 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V4
  END AS V4  ,
  CASE WHEN V5 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V5
  END AS V5  ,
  CASE WHEN V6 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V6
  END AS V6  ,
  CASE WHEN V7 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V7
  END AS V7  ,
  CASE WHEN V8 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V8
  END AS V8  ,
  CASE WHEN V9 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V9
  END AS V9  ,
  CASE WHEN V10 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V10
  END AS V10 ,
  CASE WHEN V11 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V11
  END AS V11 ,
  CASE WHEN V12 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V12
  END AS V12 ,
  CASE WHEN V13 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V13
  END AS V13 ,
  CASE WHEN V14 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V14
  END AS V14 ,
  CASE WHEN V15 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V15
  END AS V15 ,
  CASE WHEN V16 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V16
  END AS V16 ,
  CASE WHEN V17 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V17
  END AS V17 ,
  CASE WHEN V18 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V18
  END AS V18 ,
  CASE WHEN V19 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V19
  END AS V19 ,
  CASE WHEN V20 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V20
  END AS V20 ,
  CASE WHEN V21 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V21
  END AS V21 ,
  CASE WHEN V22 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V22
  END AS V22 ,
  CASE WHEN V23 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V23
  END AS V23 ,
  CASE WHEN V24 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V24
  END AS V24 ,
  CASE WHEN V25 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V25
  END AS V25 ,
  CASE WHEN V26 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V26
  END AS V26 ,
  CASE WHEN V27 IN(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13) THEN NULL
  ELSE V27
  END AS V27 from SRC_SEDSITES_BASINS
 where "site_no" not in
(select "x" from SRC_ACTUAL_LOST_SITE_11_26_13);
--rollback Drop table site_basins_ref;  
